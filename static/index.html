<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flashcards - Apprends en t'amusant!</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
</head>
<body>
<div id="app">
    <div id="user-bar" style="display: none;">
        <div id="group-info">
            <span id="group-name-display"></span>
            <button type="button" id="copy-invite-link" title="Copier le lien d'invitation">Inviter</button>
        </div>
        <span id="user-name-display"></span>
        <button type="button" id="logout-btn" title="Se deconnecter">Se deconnecter</button>
    </div>
    <h1>Super Maths!</h1>
    <img src="icons/logo-192x192.png" alt="Logo de l'application" id="app-logo">

    <!-- Section pour choisir/rejoindre un groupe (affichée pour nouveaux utilisateurs) -->
    <div id="group-section" style="display: none;">
        <h2>Bienvenue !</h2>

        <!-- Affichage quand on arrive avec un lien d'invitation -->
        <div id="group-invite-prompt" style="display: none;">
            <p>Vous avez ete invite a rejoindre le groupe :</p>
            <p id="invite-group-name" style="font-weight: bold; font-size: 1.3em; color: #667eea;"></p>
            <button type="button" id="accept-invite-btn" class="group-btn primary">Rejoindre ce groupe</button>
            <button type="button" id="decline-invite-btn" class="group-btn">Creer mon propre groupe</button>
        </div>

        <!-- Affichage pour choisir de creer ou rejoindre -->
        <div id="group-choice" style="display: none;">
            <p>Pour commencer, creez un groupe ou rejoignez un groupe existant :</p>
            <div class="group-buttons">
                <button type="button" id="create-group-btn" class="group-btn primary">Creer un groupe</button>
                <button type="button" id="join-group-btn" class="group-btn">Rejoindre un groupe</button>
            </div>
        </div>

        <!-- Formulaire pour creer un groupe -->
        <div id="create-group-form" style="display: none;">
            <h3>Creer un nouveau groupe</h3>
            <form id="new-group-form">
                <input type="text" id="new-group-name" placeholder="Nom du groupe" required>
                <button type="submit">Creer</button>
                <button type="button" id="cancel-create-group">Annuler</button>
            </form>
        </div>

        <!-- Formulaire pour rejoindre un groupe -->
        <div id="join-group-form" style="display: none;">
            <h3>Rejoindre un groupe</h3>
            <p style="font-size: 0.9em; color: #666;">Collez le lien d'invitation ou la cle secrete du groupe :</p>
            <form id="join-existing-form">
                <input type="text" id="group-secret-key" placeholder="Lien ou cle secrete" required>
                <button type="submit">Rejoindre</button>
                <button type="button" id="cancel-join-group">Annuler</button>
            </form>
            <p id="join-error" style="color: red; display: none;"></p>
        </div>
    </div>

    <!-- Section pour saisir le nom (affichée si le cookie est absent) -->
    <div id="name-section" style="display: none;">
        <h2>Entrez votre nom :</h2>
        <form id="name-form">
            <input type="text" id="player-name" name="player-name" placeholder="Votre nom" required>
            <button type="submit" id="save-name">Enregistrer</button>
        </form>
    </div>

    <!-- Nouvelle section pour la sélection des tables -->
    <div id="table-selection">
        <h2 id="selection-title">Sélectionnez les tables :</h2>
        <form id="table-form">
            <div class="mode-selector">
                <label><input type="radio" name="mode" id="mode-mul" value="mul" checked> Multiplications</label>
                <label><input type="radio" name="mode" id="mode-add" value="add"> Additions (1 à 12)</label>
                <label><input type="radio" name="mode" id="mode-sub" value="sub"> Soustractions (1 à 12)</label>
                <label><input type="radio" name="mode" id="mode-fact" value="fact"> Exo Mama</label>
                <label><input type="radio" name="mode" id="mode-mega" value="mega"> Megamix (100 questions)</label>
            </div>
            <!-- Bouton placé juste sous le titre, avant les options -->
            <div class="table-actions top-actions">
                <button type="button" id="unselect-all">Tout désélectionner</button>
            </div>
            <div id="checkboxes">
                <!-- Les cases à cocher seront générées dynamiquement -->
            </div>
            <div class="table-actions">
                <button type="submit" id="start-button">C'est parti !</button>
            </div>
            <div class="scores-link">
                <a href="scores.html">Voir le tableau des scores</a>
                <a href="tables.html">Voir les tables</a>
            </div>
        </form>
    </div>

    <!-- Section des flashcards (cachée au départ) -->
    <div id="flashcard" style="display: none;">
        <p id="question">Chargement...</p>
        <input type="number" id="answer" placeholder="Votre réponse" inputmode="numeric" pattern="[0-9]*" min="0" step="1">
        <button id="submit">Valider</button>
        <button id="end">Fin</button>
        <p id="feedback"></p>
        <p id="timer"></p>
    </div>
</div>
<script>
// Configure this with your Google Apps Script Web App URL that appends to your Sheet
// Example: window.SHEETS_WEBHOOK_URL = "https://script.google.com/macros/s/AKfycb.../exec";
window.SHEETS_WEBHOOK_URL = "";
</script>
<script src="gifs.js"></script>
<script src="app.js"></script>

<!-- Celebration overlay -->
<div id="celebration-overlay" style="display: none;">
    <div id="celebration-content">
        <h1 id="celebration-message"></h1>
        <img id="celebration-gif" src="" alt="Celebration!">
        <p id="celebration-subtitle"></p>
        <button id="celebration-close">Super !</button>
    </div>
</div>
<div id="buy_me_a_coffee">
    <a href="https://buymeacoffee.com/mathieuchauvet" target="_blank">
        <img src="https://cdn.buymeacoffee.com/buttons/default-orange.png" alt="Buy Me A Coffee" style="height: 60px !important;width: 217px !important;" >
    </a>
</div>
</body>
</html> 
